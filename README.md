# TokyoVariant
東京都におけるデルタ変異株を含む L452R 変異を持つ変異株の割合を、「東京都新型コロナウイルス感染症対策本部報」その他のデータから分析し予測します。

言語は Julia を用いており、module と function に分けてはいますが、過度に構造化せず繰り返しを厭わずに、ほぼ上から単調的に処理していくプログラムとなっています。
一部の処理に時間がかかるため、処理は以下のような複数のファイルと module に分割されています。

- TokyoVariantAnalysis4.jl 本部報の変異 PCR の結果をもとに手動で作成した CSV を読み込み、割合やオッズといった統計量を算出して DataFrame とします。
- TokyoVariantAnalysis4A.jl L452R 変異の割合のロジットが 1 次関数となるというモデルを元に、パラメーター空間を探索して尤度を求めます。フィッテイングにおいては、サンプルサイズと割合がともに小さなものがデータに含まれ標本誤差の分布が大きく歪むため、最小二乗法を用いた回帰ではなくできるだけ元の分布の形を保持したままパラメーター空間を探索して尤度を求めるという方法を用いています。探索にいくらかの時間を要します。
- TokyoVariantAnalysis4B.jl 求めた尤度から横軸時間、縦軸をロジットとしたヒートマップ用の Array を作成します。実行には十分程度の時間がかかります（並列処理しないCore i3 2GHz+RAM 8GBのとき）。
- TokyoVariantAnalysis4C.jl 上 (-4B) に対応するプロットを作成します。
- TokyoVariantAnalysis4B2.jl 縦軸を通常の割合に変えたヒートマップ用 Array を作成します。-4B と同様に実行には時間がかかります。
- TokyoVariantAnalysis4C2.jl -4B2 に対応するプロットを作成します。
- TokyoConfirmed4.jl 新規確認感染者数の CSV を読み込むとともに、ここまでで推定した L452R の割合を用いて、今後の予測を行い、プロットを作成します。

各プログラムはファイル名と同じ module に入っており、前の結果を参照していますので、基本的には、上のプログラムを Julia REPL から順に include しています。
プロットは -4C, -4C2, -Confirmed4 module の下の plots Dict に格納されています。

なお CSV ファイルはサンプルです。Github 上での更新の予定はありません。

